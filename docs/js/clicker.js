"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function e(t,r,o){function n(a,c){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!c&&l)return l(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var s=r[a]={exports:{}};t[a][0].call(s.exports,function(e){var r=t[a][1][e];return n(r||e)},s,s.exports,e,t,r,o)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)n(o[a]);return n}({1:[function(e,t,r){var o;r.open=function(e){var t=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,r=t.open("DonutClicker",1);r.onupgradeneeded=function(e){if(console.log("[IndexedDB] Database upgrade."),o=e.target.result,!o.objectStoreNames.contains("clickerStore")){o.createObjectStore("clickerStore",{keyPath:"key"}).createIndex("key","key",{unique:!0})}},r.onsuccess=function(t){console.log("[IndexedDB] Database initialised."),o=t.target.result,o.onerror=function(e){console.error("[IndexedDB] error: "+e.target.errorCode)},e&&e()},r.onerror=function(e){console.error("[IndexedDB] Opening error.")}},r.save=function(e,t){if(!o)return alert("Open database at first"),!1;o.transaction(["clickerStore"],"readwrite").objectStore("clickerStore").put({key:e,value:t}).onerror=function(e){console.error("[IndexedDB] Error: "+e)}},r.load=function(e){if(!o)return alert("Open database at first"),!1;var t=o.transaction(["clickerStore"],"readonly"),r=t.objectStore("clickerStore"),n=r.getAll();n.onsuccess=function(t){e(n.result)}}},{}],2:[function(e,t,r){var o=function(e){this.money=e.money||0,this.clicks=e.clicks||0};t.exports=o},{}],3:[function(require,module,exports){require("./donut");var Upgrade=require("./upgrade"),Database=require("./database");"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("Service-Worker.js").then(function(e){console.log("ServiceWorker registration successful with scope:",e.scope)},function(e){console.log("ServiceWorker registration failed: ",e)})});var clickerModule=function(){var $donut=document.querySelector("#donut"),$clicks=document.querySelector("#clicks"),$money=document.querySelector("#money"),money=0,clicks=0,moneyOnClick=1,moneyPerTime=1,moneyEveryTime=3e5,database,countClick=function(){clicks++,$clicks.innerHTML=clicks,Database.save("clicks",clicks)},clickMoney=function(){updateMoney(money+moneyOnClick)},timeMoney=function e(){updateMoney(money+moneyPerTime),setTimeout(e,moneyEveryTime)},updateMoney=function(e){money=e,$money.innerHTML=e,Database.save("money",e)},clickUpgrade=new Upgrade({requiredMoney:20,obtainedMoney:1,moneyMultiplier:3,upgradeMultiplier:2,btnElement:document.querySelector("#clickUpgrade"),donutElement:document.querySelectorAll(".donut__topping")}),moneyEveryTimeUpgrade=new Upgrade({requiredMoney:100,obtainedMoney:300,moneyMultiplier:2,upgradeMultiplier:.98,btnElement:document.querySelector("#timeUpgrade"),statElement:document.querySelector("#moneyEveryTime"),donutElement:document.querySelectorAll(".donut__frostig")}),moneyPerTimeUpgrade=new Upgrade({requiredMoney:50,obtainedMoney:1,moneyMultiplier:2.25,upgradeMultiplier:2,btnElement:document.querySelector("#moneyTimeUpgrade"),statElement:document.querySelector("#moneyPerTime"),donutElement:document.querySelectorAll(".donut__cake")}),handleEvents=function(){$donut.addEventListener("click",function(){countClick(),clickMoney()}),$donut.addEventListener("mousedown",function(e){e.preventDefault()},!1),clickUpgrade.btn.addEventListener("click",function(){var e=clickUpgrade.boost(money);e&&(updateMoney(e.newMoney),moneyPerTime=e.newUpgrade,Database.save("moneyOnClick",{color:clickUpgrade.eC,level:clickUpgrade.level}))}),moneyEveryTimeUpgrade.btn.addEventListener("click",function(){var e=moneyEveryTimeUpgrade.boost(money);e&&(moneyEveryTime=1e3*e.newUpgrade,window.clearTimeout(timeMoney),setTimeout(timeMoney,moneyEveryTime),updateMoney(e.newMoney),Database.save("moneyEveryTime",{color:moneyEveryTimeUpgrade.eC,level:moneyEveryTimeUpgrade.level}))}),moneyPerTimeUpgrade.btn.addEventListener("click",function(){var e=moneyPerTimeUpgrade.boost(money);e&&(updateMoney(e.newMoney),moneyPerTime=e.newUpgrade,Database.save("moneyPerTime",{color:moneyPerTimeUpgrade.eC,level:moneyPerTimeUpgrade.level}))})},setStats=function setStats(stats){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _iterator=stats[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var stat=_step.value;if("object"!==_typeof(stat.value)&&stat.value.constructor!==Object)eval(stat.key+" = "+stat.value);else switch(stat.key){case"moneyPerTime":moneyPerTime=moneyPerTimeUpgrade.load(stat.value);break;case"moneyEveryTime":moneyEveryTime=1e3*moneyEveryTimeUpgrade.load(stat.value);break;case"moneyOnClick":moneyOnClick=clickUpgrade.load(stat.value)}}}catch(e){_didIteratorError=!0,_iteratorError=e}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}document.querySelector("#moneyEveryTime").innerHTML=moneyEveryTime/1e3,document.querySelector("#moneyPerTime").innerHTML=moneyPerTime,$clicks.innerHTML=clicks,$money.innerHTML=money},setIntervals=function(){setTimeout(timeMoney,moneyEveryTime),setInterval(function(){clickUpgrade.checkUpgradeAvailable(money)},200),setInterval(function(){moneyEveryTimeUpgrade.checkUpgradeAvailable(money)},200),setInterval(function(){moneyPerTimeUpgrade.checkUpgradeAvailable(money)},200)},init=function(){handleEvents(),Database.open(function(){Database.load(setStats),setIntervals()})}()}()},{"./database":1,"./donut":2,"./upgrade":5}],4:[function(e,t,r){var o=function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e};t.exports=o},{}],5:[function(e,t,r){var o=e("./randomColor"),n=function(e){this.level=1,this.btn=e.btnElement,this.rM=e.requiredMoney,this.mM=e.moneyMultiplier,this.oM=e.obtainedMoney,this.uM=e.upgradeMultiplier,this.dE=e.donutElement,this.eC=e.color||o(),e.hasOwnProperty("statElement")&&(this.sE=e.statElement)};n.prototype.boost=function(e){if(e<this.rM)return!1;this.level++,this.btn.previousElementSibling.children[1].innerHTML=this.level,this.checkUpgradeAvailable();var t=parseInt(e-this.rM);return this.rM=this.rM*this.mM,this.oM=parseInt(this.oM*this.uM),this.hasOwnProperty("sE")&&(this.sE.innerHTML=this.oM),this.setColor(o()),{newMoney:t,newUpgrade:parseInt(this.oM)}},n.prototype.setColor=function(e){var t=this;this.eC=e,this.dE.forEach(function(e){e.style.fill=t.eC})},n.prototype.checkUpgradeAvailable=function(e){this.rM<=e?this.btn.parentElement.classList.remove("disabled"):this.btn.parentElement.classList.add("disabled")},n.prototype.load=function(e){var t=e.level,r=e.color;if(t){for(;this.level!=t;)this.boost(9999999999999);return r&&this.setColor(r),parseInt(this.oM)}},t.exports=n},{"./randomColor":4}]},{},[3]);
//# sourceMappingURL=maps/clicker.js.map
